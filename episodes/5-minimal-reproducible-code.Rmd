---
title: "Minimal Reproducible Code"
teaching: 10
exercises: 2
---

::: questions
- Which parts of my code are directly relevant to my problem?
- Which parts of my code are necessary in order for the problem area to run correctly?
- I feel overwhelmed by this script--where do I even start?
- Why can't I just post my whole script?
:::

::: objectives
- Explain the value of a minimal code snippet.
- Simplify a script down to a minimal code example.
- Have a road map to follow to simplify your code. [metacognitive LO]
- Identify the problem area of the code.
- Identify supporting parts of the code that are essential to include.
- Identify pieces of code that can be removed without affecting the central functionality.
:::

## Why is it important to simplify code?

::::::::::::::::::::::::::::::::::::::::::: challenge
**Exercise:** Imagine you're opening up a project after a long time away from it. You know you were stuck on one of the scripts, so you open it up to try to figure out what's going on. (If you have easy access to one of your past projects, try this in real time!)

On the Etherpad, write a few notes about the thoughts and feelings you experience when you do this. How do you feel about diving into this script again?
::::::::::::::::::::::::::::::::::::::::::: 

Now imagine that your colleague sends you *their* analysis script. It's broken and they want help fixing it. You open the script in R and it runs. Awesome! But now you're staring at a long complicated script, and you're not really sure where to start on fixing the problem.
- Ugh, this is going to take a long time. You're not exactly excited to dive into it.

When someone is doing you the favor of helping you figure out what's wrong with your code, the happier you make them, the likelier they are to help you quickly and easily. Why lay more barriers in their way?

This is especially important with strangers on the internet who don't have a pre-existing relationship with you. They're only going to help if you make it really really easy for them to do so.

XXX exercise that puts them in the shoes of the person receiving the example and trying to run it, so they feel how annoying it is.
XXX do we really need to hit them over the head with this? Maybe they get it already?

## Where is the problem area

So we've seen that simplifying your code down [helps other people help you](LINK TO JENNY BRYAN'S TALK) and gets you answers more quickly. But how do we actually go about doing that?

In this episode, we're going to walk you through a road map of steps for approaching your code and breaking it down into its simplest form while making sure that 1) it still runs and 2) it still reproduces the problem you actually care about solving. In the last episode, we saw that a minimal dataset isn't useful if it doesn't demonstrate the thing you're trying to focus on! The same thing applies to code.

For now, we'll go through this road map step by step. At the end, we'll review it. One thing we want you to take away from this lesson is that there is a step by step process to follow, and you can refer back to it if you feel lost in the future.

**Step 1: Identify the problem area.**

Sometimes, it's really easy to tell which part of your code is broken. Everything was working, and then suddenly you add a new line and it generates an error message. But sometimes it's more subtle. Maybe there's no error message, but the plot you're producing doesn't look like you want it to. Maybe things were working last time you ran the script, but since then you've added 50 more lines of code and now it doesn't work well.

XXX EXAMPLE WHERE THE PLOT CREATED DOESN'T MATCH WHAT THEY WERE GOING FOR (because that's easier to debug than an actual error message). XXX we need to focus more on actual errors in this lesson I think... can add that in later.

Which line of code created that plot?
- If you're not sure, try stepping through your code line by line.

XXX start here
---------
## The road map for simplifying your code
0. Make a new script to hold your reproducible example.
1. Where is the problem area? (What is breaking?)
  - add it to the script
2. What is needed to run this code?
  A. Variables
    Ex: ID all the variables used
  B. Packages
    Ex: ID all the packages used
    ! Not all functions are obviously attached to a package!
      - shortcut: all packages you loaded
        Ex: Why not? What's the drawback of this?
      - double colon :: for defining functions (a useful exercise for you, if nothing else!)
        Ex: What might be missed by this? Are there any important things that can't be defined by the double colon?
      - search for function in help docs
3. Add the packages as library() calls at the top of the script
    ! What if someone doesn't have the package installed? Typically we don't include `install.packages()` in our code. We assume that people will see the library() calls and take action to install the packages themselves. However, there is an alternative approach [instert content/example of the if(require()) thing--but note that explaining this properly requires explaining why require() is different from library(), why it returns a logical, etc. and is kind of a rabbit hole that I don't really want to go down.]
4. Where are the variables defined, and what do they depend on?
  Ex: draw a tree
  - Add those necessary parts in your new minimal script.
    ! Wow this is getting long! If the previous code has a lot of data wrangling steps, including all the dependencies won't really help simplify things. What can you do instead?
      Ex: brainstorm ways you could use a minimal dataset here instead of your literal data
        ! Using a minimal dataset simplifies not just the data but also the code!! Key takeaway.
5. Can we pare this down even more?
  - General procedure: remove something and test whether it breaks the key problem.
  Ex: removing various things, observing what happens, identifying whether or not we care about those things. (Need to include at least one that's tricky, like maybe it does change the actual values but it doesn't change their relationship to each other)

Ex: reflection. That was a lot! Let's take a moment to think.
- What's one thing you learned in this episode, an insight, etc?
- What's one thing you're still confused about?

Putting it all together: Given a broken script, can you reduce it down to its smallest parts and make a minimal reprex?
    
Box [ROAD MAP IN SIMPLE TERMS]
    
    
